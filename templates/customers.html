{% extends "base.html" %}

{% block content %}
  <section class="page-section">
    <div class="section-heading">
      <h2>Customers</h2>
      <p>Manage customer profiles and notes for faster dispatch planning.</p>
    </div>

    {% if success_message %}
      <div class="banner">{{ success_message }}</div>
    {% endif %}

    <article class="card">
      <h3>Add Customer</h3>
      <form class="form-stack" method="post" action="{{ url_for('add_customer') }}">
        <div>
          <label for="name">Name</label>
          <input id="name" name="name" type="text" value="{{ form_data.name }}" required>
          {% if errors.name %}
            <span class="form-error">{{ errors.name }}</span>
          {% endif %}
        </div>

        <div>
          <label for="zip">ZIP</label>
          <input id="zip" name="zip" type="text" value="{{ form_data.zip }}" required>
          {% if errors.zip %}
            <span class="form-error">{{ errors.zip }}</span>
          {% endif %}
        </div>

        <div>
          <label for="notes">Notes</label>
          <textarea id="notes" name="notes" rows="3">{{ form_data.notes }}</textarea>
        </div>

        <div>
          <button class="btn" type="submit">Add Customer</button>
        </div>
      </form>
    </article>

    <article class="card">
      <h3>Customer List</h3>
      {% if customers %}
        <div class="table-wrapper">
          <table class="data-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>ZIP</th>
                <th>Notes</th>
                <th>Created</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for customer in customers %}
                <tr>
                  <td>{{ customer.name }}</td>
                  <td>{{ customer.zip }}</td>
                  <td>{{ customer.notes or '' }}</td>
                  <td>{{ customer.created_at }}</td>
                  <td class="table-actions">
                    <form method="post" action="{{ url_for('delete_customer', customer_id=customer.id) }}">
                      <button class="btn btn-danger" type="submit">Delete</button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="empty-state">No customers yet. Add your first customer to get started.</div>
      {% endif %}
    </article>
  </section>
{% endblock %}
